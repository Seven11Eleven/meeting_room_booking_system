### Система бронирования конференц-залов

**Задача:**

Создать простой веб-сервис для системы бронирования конференц-залов на определенные временные слоты. 
Основная цель задания — убедиться, что система бронирования соблюдает строгий инвариант: **два бронирования не могут пересекаться по времени для одного и того же зала**. Этот инвариант должен быть обеспечен на уровне приложения, **без** использования PostgreSQL constraints на уровне базы.

### Описание задачи:

1. **Создать REST API для системы бронирования:**
   - API должно поддерживать следующие операции:
     - **Создание нового бронирования** для конференц-зала.
     - **Получение всех бронирований** для конференц-зала.
   
   - **API Endpoints:**
     - `POST /reservations`: Создание нового бронирования.
       - **Тело запроса**:
         - `room_id` (string): Уникальный идентификатор зала.
         - `start_time` (timestamp): Время начала бронирования.
         - `end_time` (timestamp): Время окончания бронирования.
       - **Ответ**:
         - `201 Created` при успешном создании бронирования.
         - `409 Conflict` если бронирование пересекается с существующим бронированием для того же зала.
     - `GET /reservations/{room_id}`: Получение всех бронирований для заданного зала.
       - **Ответ**:
         - `200 OK` со списком бронирований.

2. **Реализовать логику бронирования с обеспечением инварианта:**
   - Приложение должно гарантировать, что два бронирования не могут пересекаться по времени для одного и того же зала. Это должно быть сделано **на уровне приложения**.

3. **Настроить базу данных PostgreSQL:**
   - Спроектировать простую схему базы данных для хранения бронирований. Схема должна включать следующие колонки: `id`, `room_id`, `start_time`, `end_time`.
   - Убедиться, что база данных включена в конфигурацию Docker compose.

4. **Настроить docker-а:**
   - Создать `Dockerfile` для Go-приложения.
   - Создать файл `docker-compose.yml` для настройки Go-приложения и базы данных PostgreSQL.
   - Убедиться, что и Go-приложение, и база данных PostgreSQL могут быть запущены вместе одной командой.

5. **Написать тесты:**
   - Написать тесты для логики бронирования, чтобы проверить, что:
     - Бронирования могут быть успешно созданы без пересечений.
     - Пересекающиеся бронирования корректно идентифицируются и отклоняются.
   - Написать тесты, которые симулируют конкурентные (одновременные) запросы на бронирование одного и того же зала и проверяют, что инвариант (отсутствие пересекающихся бронирований) соблюдается. 
   - Использовать Docker для запуска экземпляра PostgreSQL для тестирования. Убедиться, что тесты автоматизированы и могут быть запущены одной командой (например, `make test`).

### Требования по используемым библиотекам:

- https://github.com/jackc/pgx для взаимодействия с базой
- https://github.com/go-chi/chi для API

### Требования к сдаче задания:

- Предоставить ссылку на репозиторий GitHub с исходным кодом.
- Включить файл `README.md` с инструкциями по запуску приложения, запуску тестов и любой другой необходимой информацией.
- Убедиться, что приложение может быть запущено с использованием Docker Compose.

### Критерии оценки:

- **Корректность:** Решение должно правильно реализовывать API и обеспечивать инвариант бронирования с использованием логики на уровне приложения.
- **Качество кода:** Код должен быть чистым, читабельным
- **Обработка конкурентных запросов:** Правильная обработка конкурентных запросов, обеспечивающая, что для одного и того же зала не могут быть созданы пересекающиеся бронирования.
- **Тестирование:** Достаточное покрытие тестами, особенно для edge-case и конкурентных запросов.
- **Использование Docker:** Корректное использование Docker как для развертывания приложения, так и для тестирования с PostgreSQL.
- **Документация:** Четкая и лаконичная документация по запуску приложения и тестов.

### Условия
На сдачу задания дается не более 4 дней с момента получения задания, скорость сдачи тоже оценивается при прочих равных показателях.
Решения с ссылкой на github присылать мне на почту: ----
По всем вопросам по заданию - писать на эту же почту.
Удачи!

- ## **Документация**

### Как запустить приложение?
``` bash
git clone https://github.com/Seven11Eleven/meeting_room_booking_system

cd meeting_room_booking_system

docker compose up --build
```

### Как запустить тесты? (2 способа)

- **Первый способ**:
``` bash
make test
```

После ввода этой команды, свое выполнение начнет Makefale, который поднимет тестовую БД и запустит все тесты

- **Второй способ**:
``` bash
docker compose -f docker-compose.test.yaml up --build
```
дождитесь пока поднимется бд и отработают миграции, после пропишите в терминал(находясь в корневой директории проекта)
``` bash
go test ./internal/services -v
```

Плюс этого способа в том, что вы можете сами отслеживать то, какие запросы происходят, через логи postgresql в запущенном контейнере, а также можете войти в сам контейнер и проверять каждый кейс теста вручную, чтобы это сделать после запуска контейнера откройте другой терминал, в нем пропишите
``` bash
docker exec -it meeting_room_booking_system-db_test-1 /bin/sh

psql -U testuser -d testdb
```

## **API-ENdpoints**
- # **GET http://localhost:8080/reservations/{room_id} - выдает все резервации для конференц-зала**

```bash
curl -X GET http://localhost:8080/reservations/{room_id}
```

- # **POST http://localhost:8080/reservations - Делает резерв в конференц зале на указанное время**
```json
{
    "room_id": "411",
           "start_time": "2025-09-01T12:10:00Z",
           "end_time": "2025-09-01T14:00:00Z"
}
```


```bash
curl -X POST http://localhost:8080/reservations \
-H "Content-Type: application/json" \
-d '{
    "room_id": "411",
    "start_time": "2025-09-01T12:10:00Z",
    "end_time": "2025-09-01T14:00:00Z"
}'

```

- # **DELETE http://localhost:8080/reservations - Отменяет резерв в конференц зале на указанное время** 
```json
{
    "room_id": "411",
           "start_time": "2025-09-01T12:10:00Z",
           "end_time": "2025-09-01T14:00:00Z"
}
```

```bash
curl -X DELETE http://localhost:8080/reservations \
-H "Content-Type: application/json" \
-d '{
    "room_id": "411",
    "start_time": "2025-09-01T12:10:00Z",
    "end_time": "2025-09-01T14:00:00Z"
}'
```